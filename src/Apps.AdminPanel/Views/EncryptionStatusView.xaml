<UserControl x:Class="Apps.AdminPanel.Views.EncryptionStatusView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:components="clr-namespace:Apps.AdminPanel.Components"
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="600"
             FlowDirection="RightToLeft"
             Loaded="UserControl_Loaded">

    <UserControl.Resources>
        <Storyboard x:Key="SpinAnimation">
            <DoubleAnimation Storyboard.TargetName="SpinningIcon"
                             Storyboard.TargetProperty="(UIElement.RenderTransform).(RotateTransform.Angle)"
                             From="0" To="360" Duration="0:0:2" 
                             RepeatBehavior="Forever"/>
        </Storyboard>
    </UserControl.Resources>

    <Grid>
        <!-- العنوان الرئيسي -->
        <TextBlock Text="حالة التشفير" 
                   Foreground="{StaticResource TextPrimary}" 
                   FontSize="26" FontWeight="SemiBold" 
                   HorizontalAlignment="Center" 
                   VerticalAlignment="Top"
                   Margin="0,0,0,25"/>

        <!-- البطاقة الرئيسية -->
        <Border Margin="20,50,20,20"
                BorderBrush="{StaticResource BorderColor}"
                BorderThickness="1"
                CornerRadius="4"
                Background="{StaticResource PanelBackground}">

            <!-- ظل خفيف للبطاقة -->
            <Border.Effect>
                <DropShadowEffect Color="Black" BlurRadius="10" ShadowDepth="2" Opacity="0.2"/>
            </Border.Effect>

            <Grid Margin="30">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <!-- قسم التقدم -->
                    <RowDefinition Height="Auto"/>
                    <!-- قسم التفاصيل -->
                    <RowDefinition Height="Auto"/>
                    <!-- الأزرار -->
                </Grid.RowDefinitions>

                <!-- القسم الأول: شريط التقدم والأيقونة -->
                <Border Grid.Row="0" 
                        Background="{StaticResource AppBackground}" 
                        BorderBrush="{StaticResource BorderColor}" 
                        BorderThickness="1" 
                        CornerRadius="4" 
                        Padding="20" 
                        Margin="0,0,0,20">

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- أيقونة الدوران -->
                        <Grid Grid.Column="0" Width="70" Height="70" Margin="0,0,20,0">
                            <!-- دائرة خلفية خافتة -->
                            <Ellipse Stroke="{StaticResource AccentColor}" StrokeThickness="2" Opacity="0.1"/>

                            <Grid x:Name="SpinningIcon" RenderTransformOrigin="0.5,0.5">
                                <Grid.RenderTransform>
                                    <RotateTransform Angle="0"/>
                                </Grid.RenderTransform>
                                <materialDesign:PackIcon Kind="Loading" Width="50" Height="50" 
                                                       Foreground="{StaticResource AccentColor}" 
                                                       HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Grid>

                            <materialDesign:PackIcon Kind="LockOutline" Width="24" Height="24" Foreground="{StaticResource TextPrimary}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Grid>

                        <!-- تفاصيل التقدم -->
                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <Grid Margin="0,0,0,5">
                                <TextBlock Text="جاري معالجة البيانات..." Foreground="{StaticResource TextPrimary}" FontWeight="Medium" HorizontalAlignment="Left"/>
                                <TextBlock x:Name="TxtPercent" Text="45%" Foreground="{StaticResource AccentColor}" FontWeight="Bold" HorizontalAlignment="Left" Margin="150,0,0,0"/>
                            </Grid>

                            <ProgressBar x:Name="MainProgressBar" 
                                         Value="45" Maximum="100" 
                                         Height="10" 
                                         Margin="0,5"
                                         Foreground="{StaticResource AccentColor}" 
                                         Background="{StaticResource ControlBackground}" 
                                         BorderThickness="0"/>

                            <TextBlock x:Name="TxtFileName" 
                                       Text="الملف الحالي: document_secure.pdf" 
                                       Foreground="{StaticResource TextSecondary}" 
                                       FontSize="12" 
                                       HorizontalAlignment="Left"
                                       Margin="0,5,0,0"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- القسم الثاني: التفاصيل التقنية -->
                <Border Grid.Row="1" 
                        BorderBrush="{StaticResource BorderColor}" 
                        BorderThickness="0,0,0,1" 
                        Padding="0,0,0,20" 
                        Margin="0,0,0,20">

                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                            <materialDesign:PackIcon Kind="InformationOutline" Foreground="{StaticResource TextSecondary}" VerticalAlignment="Center"/>
                            <TextBlock Text="تفاصيل العملية" Foreground="{StaticResource TextPrimary}" FontSize="16" FontWeight="SemiBold" Margin="8,0,0,0"/>
                        </StackPanel>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <!-- Labels -->
                                <ColumnDefinition Width="*"/>
                                <!-- Values -->
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- الصف 1: الخوارزمية -->
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="خوارزمية التشفير:" Foreground="{StaticResource TextSecondary}" Margin="0,0,0,10" Width="120"/>
                            <TextBlock Grid.Row="0" Grid.Column="1" Text="AES-256 (Military Grade)" Foreground="{StaticResource TextPrimary}" FontWeight="Medium"/>

                            <!-- الصف 2: معرف الهدف -->
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="بصمة الهدف:" Foreground="{StaticResource TextSecondary}" Margin="0,0,0,10"/>
                            <TextBlock Grid.Row="1" Grid.Column="1" x:Name="TxtTargetID" Text="A1B2-C3D4-E5F6-G7H8" Foreground="{StaticResource TextPrimary}" FontFamily="Consolas"/>

                            <!-- الصف 3: الوقت -->
                            <StackPanel Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="0,10,0,0">
                                <Border Background="{StaticResource ControlBackground}" CornerRadius="4" Padding="8,4" Margin="0,0,10,0">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="المنقضي: " Foreground="{StaticResource TextSecondary}" FontSize="12"/>
                                        <TextBlock x:Name="TxtElapsedTime" Text="00:45" Foreground="{StaticResource TextPrimary}" FontWeight="Bold" FontSize="12"/>
                                    </StackPanel>
                                </Border>

                                <Border Background="{StaticResource ControlBackground}" CornerRadius="4" Padding="8,4">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="المتبقي: " Foreground="{StaticResource TextSecondary}" FontSize="12"/>
                                        <TextBlock x:Name="TxtRemainingTime" Text="00:15" Foreground="{StaticResource AccentColor}" FontWeight="Bold" FontSize="12"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- القسم الثالث: أزرار التحكم -->
                <StackPanel Grid.Row="2">
                    <TextBlock Text="إجراءات التحكم" Foreground="{StaticResource TextSecondary}" FontSize="12" Margin="0,0,0,10"/>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="15"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- زر الإخفاء -->
                        <components:TechButton Grid.Column="0" 
                                               Title="إخفاء في الخلفية" 
                                               Icon="WindowMinimize"
                                               Background="Transparent"
                                               BorderBrush="{StaticResource BorderColor}"
                                               BorderThickness="1"
                                               HighlightBrush="{StaticResource TextPrimary}"
                                               Click="BtnHide_Click"/>

                        <!-- زر الإيقاف المؤقت -->
                        <components:TechButton Grid.Column="2" 
                                               Title="إيقاف مؤقت" 
                                               Icon="Pause"
                                               Background="Transparent"
                                               BorderBrush="{StaticResource AccentColor}"
                                               BorderThickness="1"
                                               HighlightBrush="{StaticResource AccentColor}"
                                               Click="BtnPause_Click"/>
                    </Grid>

                    <!-- زر الإلغاء (خطر) -->
                    <components:TechButton Margin="0,15,0,0"
                                           Title="إلغاء العملية بالكامل" 
                                           Icon="StopCircleOutline" 
                                           Background="Transparent"
                                           BorderBrush="{StaticResource ErrorBrush}"
                                           BorderThickness="1"
                                           HighlightBrush="{StaticResource ErrorBrush}"
                                           Click="BtnCancel_Click"/>
                </StackPanel>

            </Grid>
        </Border>
    </Grid>
</UserControl>